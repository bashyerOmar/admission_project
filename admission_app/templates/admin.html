{%extends 'base.html'%}

{%block content%}
<h4>Welcome to admin page {{user.first_name}}</h4>
<table class="table">
  <thead>
    <tr>
      <th scope="col">ID</th>
      <th scope="col">Course Name</th>
      <th scope="col">Description</th>
      <th scope="col">Available Seats</th>
      <th scope="col">Students Number: </th>
      <th scope="col">Actions: </th>
    </tr>
  </thead>
  <tbody>
    {% for course in courses %}
    <tr>
      <th scope="row">{{course.id}}</th>
      <td>{{course.name}}</td>
      <td>{{course.desc}}</td>
      {% load filters %}
      {% load mathfilters %}
      {% with count_approve=course.users.all|in_category:'approve'|length %}
      <td>{{ course.capacity|sub:count_approve }} </td>
      <td>{{ count_approve }}</td>
      {% endwith %}
      <td>
        <a class="btn btn-primary btn-light" href="/edit_course/{{course.id}}">Edit</a> |
        <a class="btn btn-primary btn-danger" href="/delete_course/{{course.id}}">Delete</a>
      </td>
    </tr>
    {%endfor%}
  </tbody>
</table>
<a class="btn btn-primary btn-light" href="/add_course">Add Course</a>
<table class="table" id="pennding">
  <thead>
    <tr>
      <th scope="col">ID</th>
      <th scope="col">Student Name</th>
      <th scope="col">Course Name</th>
      <th scope="col">CV</th>
      <th scope="col">State</th>
      <th scope="col">Actions: </th>
    </tr>
  </thead>
  {% if students %}
  <tbody>
    {% for student in students%}
    <tr>
      <th scope="row">{{student.id}}</th>
      <td>{{student.first_name}} {{student.last_name}}</td>
      <td>{{student.course.name}}</td>
      <td><a href="{{student.cv.url}}">Link</a></td>
      <td>{{student.state }}</td>
      <td><a class="btn btn-primary btn-light" href="/edit_state/{{student.id}}/approve">Approve</a> |
        <a class="btn btn-primary btn-light" href="/edit_state/{{student.id}}/decline">Decline</a>
      </td>
    </tr>
    {%endfor%}
  </tbody>
  {% else %}
<tr>
  <td colspan="5" style="text-align:center;">There is no pennding request </td>
  <td></td>
  <td></td>
  <td></td>
  <td></td>
</tr>

</table>

{% endif %}

{%endblock%}